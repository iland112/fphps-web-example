<html xmlns:th="http://www.thymeleaf.org">
  <div id="response" th:fragment="e-passport-auto-read">
    <!-- title section -->
    <div
      id="header"
      class="mt-3 px-4 sm:px-0 lg:flex lg:items-baseline lg:gap-2"
    >
      <h3 class="text-2xl font-semibold text-gray-900">Passport Information</h3>
      <p class="mt-1 max-w-2xl text-lg text-gray-500">
        Data details after reading the passport/e-passport
      </p>
      <button
        type="button"
        class="ms-80 inline-flex items-center gap-x-2 rounded-lg border border-transparent bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:bg-blue-700 focus:outline-hidden disabled:pointer-events-none disabled:opacity-50"
        hx-post="/fphps/passport/run-auto-read"
      >
        Auto Read Run
      </button>
    </div>
    <div id="title" class="mt-2 grid grid-cols-2 items-baseline px-4 sm:px-0">
      <div class="flex flex-row space-x-3 p-3">
        <img
          id="country-flag"
          class="max-w-2xl place-self-center"
          width="60"
          th:src="@{/image/flags/kr.svg}"
          alt="Country Flag"
        />
        <p
          class="max-w-2xl justify-self-stretch text-2xl font-bold text-gray-500"
        >
          <span id="span-passport-number">BC765432</span>
          / <span id="span-name">JOHN DOE</span>
        </p>
      </div>
      <svg
        class="max-w-2xl justify-self-end fill-amber-600"
        xmlns="http://www.w3.org/2000/svg"
        width="80"
        height="20"
        viewBox="0 0 210 297"
      >
        <path
          d="M-111.5625 24.75V136.125H23.539306A82.5 82.5 0 0 1 105 66 82.5 82.5 0 0 1 186.5 136.125H321.5625V24.75ZM105 90.75A57.75 57.75 0 0 0 47.25 148.5 57.75 57.75 0 0 0 105 206.25 57.75 57.75 0 0 0 162.75 148.5 57.75 57.75 0 0 0 105 90.75Zm-216.5625 70.125V272.25h433.125V160.875H186.46068A82.5 82.5 0 0 1 105 231 82.5 82.5 0 0 1 23.5 160.875Z"
          stroke-width="81.90428162"
        />
      </svg>
    </div>
    <div class="flex flex-wrap border-t border-gray-100">
      <div class="flex flex-col">
        <div id="mrz-info" class="flex space-x-4 border-t border-gray-100 p-2">
          <div id="photo" class="flex flex-row gap-2">
            <div class="flex flex-col items-center space-y-1">
              <img
                class="w-32 h-36 aspect-auto object-cover flex-none rounded-sm bg-gray-50"
                id="viz-photo"
                th:src="@{/image/image-photo.jpg}"
                alt="document-photo"
              />
              <h3 class="text-md font-semibold">Document</h3>
            </div>
            <div class="flex flex-col items-center space-y-1">
              <img
                class="w-32 h-36 aspect-auto object-cover flex-none rounded-sm bg-gray-50"
                id="epass-photo"
                th:src="@{/image/image-photo.jpg}"
                alt="chip-photo"
              />
              <h3 class="text-md font-semibold">Chip</h3>
            </div>
          </div>
          <div id="mrz-info" class="p-2">
            <dl class="grid grid-cols-3">
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  DOCUMENT TYPE
                </dt>
                <dd
                  id="doc-type"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  P
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  ISSUING STATE
                </dt>
                <dd
                  id="issuing-state"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  UTO
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  DOCUMENT NUMBER
                </dt>
                <dd
                  id="passport-number"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  BC765432
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  NAME
                </dt>
                <dd
                  id="name"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  JOHN DOE
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  NATIONALITY
                </dt>
                <dd
                  id="nationality"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  UTOPIA
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  DATE OF BIRTH
                </dt>
                <dd
                  id="birth"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  07/02/1980
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  SEX
                </dt>
                <dd
                  id="sex"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  M
                </dd>
              </div>
              <div class="flex flex-col px-2 py-2">
                <dt class="font-mono text-sm/6 font-medium text-gray-900">
                  DATE OF EXPIRY
                </dt>
                <dd
                  id="expiry-date"
                  class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
                >
                  07/02/2023
                </dd>
              </div>
            </dl>
          </div>
        </div>
        <fieldset
          id="mrz-image"
          class="p-2 flex border rounded-md border-gray-100"
        >
          <legend class="font-mono text-sm/6 font-semibold text-gray-900">
            MRZ Image
          </legend>
          <img
            class="aspect-auto h-auto w-96 flex-none rounded-sm bg-gray-50 object-cover"
            id="mrz-photo"
            th:src="@{/image/image-batch.jpg}"
            alt="mrz-photo"
          />
          <div id="mrz-ocr" class="p-2 flex flex-col gap-4">
            <dt class="font-mono text-sm/6 font-medium text-gray-900">
              Line 1
            </dt>
            <dd
              id="mrz-line-1"
              class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
            >
              LINE 1
            </dd>
            <dt class="font-mono text-sm/6 font-medium text-gray-900">
              Line 2
            </dt>
            <dd
              id="mrz-line-2"
              class="mt-1 text-sm/6 font-semibold text-gray-900 sm:col-span-2 sm:mt-0"
            >
              LINE 2
            </dd>
          </div>
        </fieldset>
        <div id="e-pass-result" class="grid grid-cols-2 gap-10">
          <fieldset
            class="grid grid-cols-4 space-x-10 rounded-sm border border-gray-300 p-2 font-mono"
            disabled
          >
            <legend>DG Read Results</legend>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg1"
              />
              <label
                for="hs-checkbox-dg1"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG01</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg2"
              />
              <label
                for="hs-checkbox-dg2"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG02</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg3"
              />
              <label
                for="hs-checkbox-dg3"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG03</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg4"
              />
              <label
                for="hs-checkbox-d04"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG04</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg5"
              />
              <label
                for="hs-checkbox-dg5"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG05</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg6"
              />
              <label
                for="hs-checkbox-dg6"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG06</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg7"
              />
              <label
                for="hs-checkbox-dg7"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG07</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg8"
              />
              <label
                for="hs-checkbox-dg8"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG08</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg9"
              />
              <label
                for="hs-checkbox-dg9"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG09</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg10"
              />
              <label
                for="hs-checkbox-dg10"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG10</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg11"
              />
              <label
                for="hs-checkbox-dg11"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG11</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg12"
              />
              <label
                for="hs-checkbox-dg12"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG12</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg13"
              />
              <label
                for="hs-checkbox-dg13"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG13</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg14"
              />
              <label
                for="hs-checkbox-dg14"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG14</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg15"
              />
              <label
                for="hs-checkbox-dg15"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG15</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-dg16"
              />
              <label
                for="hs-checkbox-dg16"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >DG16</label
              >
            </div>
          </fieldset>
          <fieldset
            class="grid grid-cols-1 rounded-sm border border-gray-300 p-2 font-mono"
            disabled
          >
            <legend>Authentication Results</legend>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-bac"
              />
              <label
                for="hs-checkbox-auth-bac"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                id="hs-label-auth-bac"
                >BAC</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-pa"
              />
              <label
                for="hs-checkbox-auth-pa"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                id="hs-label-auth-pa"
                >PA</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-aa"
              />
              <label
                for="hs-checkbox-auth-aa"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                id="hs-label-auth-aa"
                >AA</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-ca"
              />
              <label
                for="hs-checkbox-auth-ca"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                id="hs-label-auth-ca"
                >CA</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-ta"
              />
              <label
                id="hs-label-auth-ta"
                for="hs-checkbox-auth-ta"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                >TA</label
              >
            </div>
            <div class="flex">
              <input
                type="checkbox"
                class="mt-0.5 shrink-0 rounded-sm border-gray-200 text-blue-600 checked:border-blue-500 focus:ring-blue-500 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-700 dark:bg-neutral-800 dark:checked:border-blue-500 dark:checked:bg-blue-500 dark:focus:ring-offset-gray-800"
                id="hs-checkbox-auth-sac"
              />
              <label
                for="hs-checkbox-auth-sac"
                class="ms-3 text-sm text-gray-500 dark:text-neutral-400"
                id="hs-label-auth-sac"
                >SAC</label
              >
            </div>
          </fieldset>
        </div>
      </div>
      <div class="flex gap-4 justify-between">
        <div class="flex flex-col">
          <fieldset class="p-2 border rounded-md border-gray-100">
            <legend class="font-mono text-sm/6 font-semibold text-gray-900">
              WH Image
            </legend>
            <img
              class="aspect-auto h-40 w-72 flex-none rounded-sm bg-gray-50 object-cover"
              id="wh-image"
              th:src="@{/image/image-batch.jpg}"
              alt="wh-image"
            />
          </fieldset>
          <fieldset class="p-2 border rounded-md border-gray-100">
            <legend class="font-mono text-sm/6 font-semibold text-gray-900">
              IR Image
            </legend>
            <img
              class="aspect-auto h-40 w-72 flex-none rounded-sm bg-gray-50 object-cover"
              id="ir-image"
              th:src="@{/image/image-batch.jpg}"
              alt="ir-image"
            />
          </fieldset>
          <fieldset class="p-2 border rounded-md border-gray-100">
            <legend class="font-mono text-sm/6 font-semibold text-gray-900">
              UV Image
            </legend>
            <img
              class="aspect-auto h-40 w-72 flex-none rounded-sm bg-gray-50 object-cover"
              id="uv-image"
              th:src="@{/image/image-batch.jpg}"
              alt="uv-image"
            />
          </fieldset>
        </div>

        <!-- log message section -->
        <fieldset class="fieldset p-2 flex border rounded-md border-gray-100">
          <legend class="font-mono text-sm/6 font-semibold text-gray-900">Log Messages</legend>
          <textarea
            id="notifications"
            class="textarea textarea-sm w-full"
            rows="20"
            disabled
          ></textarea>
        </fieldset>
      </div>
    </div>

    <!-- SOD Information Section -->
    <div class="mt-4 px-4">
      <div id="sod-info-container">
        <!-- SOD 정보가 WebSocket을 통해 자동으로 로드됩니다 -->
      </div>
    </div>
  </div>
  <script>
    const socket = new WebSocket("ws://localhost:8080/fastpass");
    socket.onmessage = function (event) {
      const message = JSON.parse(event.data);

      // 모든 이벤트에서 parsedSOD 확인
      if (message.parsedSOD) {
        console.log("ParsedSOD found in event:", message.eventCodeString);
        console.log("ParsedSOD data:", message.parsedSOD);
        renderSODInformation(message.parsedSOD);
      }

      // console.log("event code: ", message.eventId);
      switch (message.eventCodeString) {
        case "FPHPS_EVENTS.FPHPS_EV_VIZ_PHOTO_CAPTURED":
          var el = document.querySelector("#viz-photo");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET VIZ-PHOTO");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_EPASS_READ_FACE":
          var el = document.querySelector("#epass-photo");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET EPASS-PHOTO");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_IR_MRZ_IMAGE_CAPTURED":
          var el = document.querySelector("#mrz-photo");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET MRZ-PHOTO");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_WH_IMAGE_CAPTURED":
          var el = document.querySelector("#wh-image");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET WH-IMAGE");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_IR_IMAGE_CAPTURED":
          var el = document.querySelector("#ir-image");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET IR-IMAGE");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_UV_IMAGE_CAPTURED":
          var el = document.querySelector("#uv-image");
          el.setAttribute(
            "src",
            "data:image/png;base64, " + message.image.imageData
          );
          // console.log("GET UV-IMAGE");
          break;
        case "FPHPS_EVENTS.FPHPS_EV_PAGE_CAPTURED":
          console.log("ePassResults: ", message.ePassResults);
          console.log("parsedSOD: ", message.parsedSOD);
          var checkBoxDg1 = document.querySelector("#hs-checkbox-dg1");
          checkBoxDg1.checked = message.ePassResults.dgs[0];
          var checkBoxDg2 = document.querySelector("#hs-checkbox-dg2");
          checkBoxDg2.checked = message.ePassResults.dgs[1];
          var checkBoxDg3 = document.querySelector("#hs-checkbox-dg3");
          checkBoxDg3.checked = message.ePassResults.dgs[2];
          var checkBoxDg4 = document.querySelector("#hs-checkbox-dg4");
          checkBoxDg4.checked = message.ePassResults.dgs[3];
          var checkBoxDg5 = document.querySelector("#hs-checkbox-dg5");
          checkBoxDg5.checked = message.ePassResults.dgs[4];
          var checkBoxDg6 = document.querySelector("#hs-checkbox-dg6");
          checkBoxDg6.checked = message.ePassResults.dgs[5];
          var checkBoxDg7 = document.querySelector("#hs-checkbox-dg7");
          checkBoxDg7.checked = message.ePassResults.dgs[6];
          var checkBoxDg8 = document.querySelector("#hs-checkbox-dg8");
          checkBoxDg8.checked = message.ePassResults.dgs[7];
          var checkBoxDg9 = document.querySelector("#hs-checkbox-dg9");
          checkBoxDg9.checked = message.ePassResults.dgs[8];
          var checkBoxDg10 = document.querySelector("#hs-checkbox-dg10");
          checkBoxDg10.checked = message.ePassResults.dgs[9];
          var checkBoxDg11 = document.querySelector("#hs-checkbox-dg11");
          checkBoxDg11.checked = message.ePassResults.dgs[10];
          var checkBoxDg12 = document.querySelector("#hs-checkbox-dg12");
          checkBoxDg12.checked = message.ePassResults.dgs[11];
          var checkBoxDg13 = document.querySelector("#hs-checkbox-dg13");
          checkBoxDg13.checked = message.ePassResults.dgs[12];
          var checkBoxDg14 = document.querySelector("#hs-checkbox-dg14");
          checkBoxDg14.checked = message.ePassResults.dgs[13];
          var checkBoxDg15 = document.querySelector("#hs-checkbox-dg15");
          checkBoxDg15.checked = message.ePassResults.dgs[14];
          var checkBoxDg16 = document.querySelector("#hs-checkbox-dg16");
          checkBoxDg16.checked = message.ePassResults.dgs[15];

          var bac = document.querySelector("#hs-checkbox-auth-bac");
          bac.checked = message.ePassResults.bac;
          var bacLabel = document.querySelector("#hs-label-auth-bac");
          bacLabel.innerHTML = "BAC : " + message.ePassResults.bacResultDesc;
          var pa = document.querySelector("#hs-checkbox-auth-pa");
          pa.checked = message.ePassResults.pa;
          var paLabel = document.querySelector("#hs-label-auth-pa");
          paLabel.innerHTML = "PA : " + message.ePassResults.paResultDesc;
          var aa = document.querySelector("#hs-checkbox-auth-aa");
          aa.checked = message.ePassResults.aa;
          var aaLabel = document.querySelector("#hs-label-auth-aa");
          aaLabel.innerHTML = "AA : " + message.ePassResults.aaResultDesc;
          var ca = document.querySelector("#hs-checkbox-auth-ca");
          ca.checked = message.ePassResults.ca;
          var caLabel = document.querySelector("#hs-label-auth-ca");
          caLabel.innerHTML = "CA : " + message.ePassResults.caResultDesc;
          var ta = document.querySelector("#hs-checkbox-auth-ta");
          ta.checked = message.ePassResults.ta;
          var taLabel = document.querySelector("#hs-label-auth-ta");
          taLabel.innerHTML = "TA : " + message.ePassResults.taResultDesc;
          var sac = document.querySelector("#hs-checkbox-auth-sac");
          sac.checked = message.ePassResults.sac;
          var sacLabel = document.querySelector("#hs-label-auth-sac");
          sacLabel.innerHTML = "SAC : " + message.ePassResults.sacResultDesc;
          break;
        case "FPHPS_EVENTS.FPHPS_EV_DOC_FRAME_FOUND":
          // console.log("line1: ", message.mrzLines.line1);
          var el = document.getElementById("mrz-line-1");
          if (el) {
            var line1 = message.mrzLines.line1.replace(/</g, "&lt");
            // console.log("replaced line1: ", line1);
            el.innerHTML = line1;
          }
          el = document.getElementById("mrz-line-2");
          if (el) el.innerHTML = message.mrzLines.line2;
          el = document.getElementById("mrz-line-3");
          if (el) el.innerHTML = message.mrzLines.line3 ? message.mrzLines.line3 : "";

          var mrzInfo = message.mrzInfo;
          // console.log("MRZ INFO", mrzInfo);
          el = document.querySelector("#country-flag");
          if (el) el.setAttribute("src", mrzInfo.countryFlagUrl);
          el = document.getElementById("span-passport-number");
          if (el) el.innerHTML = mrzInfo.passportNumber;
          el = document.getElementById("span-name");
          if (el) el.innerHTML = mrzInfo.name;

          el = document.getElementById("doc-type");
          if (el) el.innerHTML = mrzInfo.docType;
          el = document.getElementById("issuing-state");
          if (el) el.innerHTML = mrzInfo.issuingState;
          el = document.getElementById("name");
          if (el) el.innerHTML = mrzInfo.name;
          el = document.getElementById("passport-number");
          if (el) el.innerHTML = mrzInfo.passportNumber;
          el = document.getElementById("nationality");
          if (el) el.innerHTML = mrzInfo.nationality;
          el = document.getElementById("birth");
          if (el) el.innerHTML = mrzInfo.birth;
          el = document.getElementById("sex");
          if (el) el.innerHTML = mrzInfo.sex;
          el = document.getElementById("expiry-date");
          if (el) el.innerHTML = mrzInfo.expiryDate;
          break;
        case "FPHPS_EVENTS.FPHPS_EV_EPASS_READ_MRZ":
          console.log("FPHPS_EVENTS.FPHPS_EV_EPASS_READ_MRZ");
          // console.log(message);
          break;
        default:
          break;
      }
      // add notification messages
      // const div = document.createElement("div");
      // div.className =
      //   "p-2 bg-gray-100 dark:bg-gray-800 rounded shadow text-sm text-gray-800 dark:text-white";
      // div.textContent = message.eventCodeString + " :: " + message.lParam;
      // document.getElementById("notifications").appendChild(div);
      var messgetText =
        message.eventCodeString + " :: " + message.lParam + "\n";
      document.getElementById("notifications").append(messgetText);
    };

    // SOD 정보를 HTML로 렌더링하는 함수
    function renderSODInformation(parsedSOD) {
      const container = document.getElementById("sod-info-container");
      if (!container) {
        console.error("SOD container not found");
        return;
      }

      // ParsedSOD 데이터 구조: { dscCertificate, dgHashes, digestAlgorithmOid, signerInformation }
      let html = '<div id="sod-section" class="mt-6 space-y-4">';
      html += '<h3 class="text-xl font-semibold text-gray-800 dark:text-white">SOD (Security Object Document) Information</h3>';

      // Digest Algorithm
      html += '<div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">';
      html += '<h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2">Digest Algorithm</h4>';
      html += '<p class="text-sm text-gray-600 dark:text-gray-400">OID: ' + (parsedSOD.digestAlgorithmOid || 'N/A') + '</p>';
      html += '</div>';

      // Data Group Hashes
      if (parsedSOD.dgHashes && parsedSOD.dgHashes.length > 0) {
        html += '<div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">';
        html += '<h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2">Data Group Hashes</h4>';
        html += '<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">';
        html += '<thead><tr><th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">DG</th>';
        html += '<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Hash (Base64)</th></tr></thead>';
        html += '<tbody class="divide-y divide-gray-200 dark:divide-gray-700">';

        parsedSOD.dgHashes.forEach(function(dg) {
          html += '<tr><td class="px-4 py-2 text-sm font-medium text-gray-900 dark:text-white">DG' +
                  (dg.dgNumber < 10 ? '0' + dg.dgNumber : dg.dgNumber) + '</td>';
          html += '<td class="px-4 py-2 text-sm text-gray-600 dark:text-gray-400 font-mono break-all">' +
                  (dg.hash || 'N/A') + '</td></tr>';
        });

        html += '</tbody></table></div></div>';
      }

      // DSC Certificate
      if (parsedSOD.dscCertificate) {
        const cert = parsedSOD.dscCertificate;
        html += '<div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">';
        html += '<h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-3">Document Signer Certificate (DSC)</h4>';

        // Subject & Issuer
        html += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">';
        html += '<div><p class="text-xs font-medium text-gray-500 uppercase mb-1">Subject</p>';
        html += '<p class="text-sm text-gray-900 dark:text-white break-all">' + (cert.subject || 'N/A') + '</p></div>';
        html += '<div><p class="text-xs font-medium text-gray-500 uppercase mb-1">Issuer</p>';
        html += '<p class="text-sm text-gray-900 dark:text-white break-all">' + (cert.issuer || 'N/A') + '</p></div>';
        html += '</div>';

        // Validity
        html += '<div class="mb-4"><p class="text-xs font-medium text-gray-500 uppercase mb-1">Validity Period</p>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">From: ' + (cert.notBefore || 'N/A') + '</p>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">To: ' + (cert.notAfter || 'N/A') + '</p>';
        html += '<p class="text-sm font-medium ' + (cert.valid ? 'text-green-600' : 'text-red-600') + '">' +
                (cert.valid ? '✓ Valid' : '✗ Expired') + '</p></div>';

        // Public Key
        html += '<div class="mb-4"><p class="text-xs font-medium text-gray-500 uppercase mb-1">Public Key</p>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">Algorithm: ' + (cert.publicKeyAlgorithm || 'N/A') + '</p>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">Size: ' + (cert.publicKeySize || 'N/A') + ' bits</p></div>';

        // Fingerprints
        html += '<div class="mb-4"><p class="text-xs font-medium text-gray-500 uppercase mb-1">Fingerprints</p>';
        html += '<p class="text-xs text-gray-600 dark:text-gray-400 font-mono break-all">SHA-1: ' +
                (cert.sha1Fingerprint || 'N/A') + '</p>';
        html += '<p class="text-xs text-gray-600 dark:text-gray-400 font-mono break-all">SHA-256: ' +
                (cert.sha256Fingerprint || 'N/A') + '</p></div>';

        html += '</div>';
      }

      // Signer Information
      if (parsedSOD.signerInfo) {
        const signer = parsedSOD.signerInfo;
        html += '<div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">';
        html += '<h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2">Signer Information</h4>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">Digest Algorithm: ' +
                (signer.digestAlgorithmName || signer.digestAlgorithmOid || 'N/A') + '</p>';
        html += '<p class="text-sm text-gray-600 dark:text-gray-400">Signature Algorithm: ' +
                (signer.signatureAlgorithmName || signer.signatureAlgorithmOid || 'N/A') + '</p>';
        html += '</div>';
      }

      html += '</div>';
      container.innerHTML = html;
      console.log("SOD information rendered successfully");
    }
  </script>
</html>
